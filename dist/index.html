<!-- index.html - Point d'entr√©e principal de l'application Azure Network Cartography -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Azure Network Cartography</title>

    <!-- ‚Äî‚Äî Tailwind CDN pour le style utilitaire ‚Äî‚Äî -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- ‚Äî‚Äî Styles sp√©cifiques aux composants (glassy¬†/¬†gradient) ‚Äî‚Äî -->
    <link rel="stylesheet" href="./styles/components.css" />

    <!-- ‚Äî‚Äî CSS minimal ¬´¬†plein‚Äë√©cran¬†¬ª pour le canvas Cytoscape ‚Äî‚Äî -->
    <style>
      html,
      body {
        height: 100%;
        margin: 0;
      }
      /* Le conteneur Cytoscape occupe tout l'espace sous le header (4‚ÄØrem) */
      #cy {
        height: calc(100% - 4rem);
      }
    </style>

    <!-- ‚Äî‚Äî Cytoscape.js + layout fcose ‚Äî‚Äî -->
    <script src="https://unpkg.com/cytoscape@3.26.1/dist/cytoscape.min.js"></script>
    <script src="https://unpkg.com/cytoscape-fcose@2.3.2/cytoscape-fcose.js"></script>
    <script>
      // Activation conditionnelle du plugin lorsque les bundles sont charg√©s
      if (window.cytoscape && window.cytoscapeFcose) {
        cytoscape.use(window.cytoscapeFcose);
      }
    </script>

    <!-- ‚Äî‚Äî MicroModal pour les popups ‚Äî‚Äî -->
    <script src="https://unpkg.com/micromodal/dist/micromodal.min.js"></script>
  </head>

  <body class="bg-slate-900 text-slate-100 flex flex-col">
    <!-- ‚ñë‚ñë‚ñë Header ‚ñë‚ñë‚ñë -->
    <header
      class="p-4 bg-slate-800 flex items-center gap-4 shadow-lg z-10"
    >
      <h1 class="text-2xl font-bold flex-1">üåê Azure Network Cartography</h1>

      <button
        id="legendBtn"
        class="px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg text-sm"
      >
        ‚ÑπÔ∏è L√©gende
      </button>

      <input
        id="fileInput"
        type="file"
        accept="application/json"
        class="file:ml-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-600 file:text-white hover:file:bg-indigo-500"
      />
    </header>

    <!-- ‚ñë‚ñë‚ñë Viewport du graphe ‚ñë‚ñë‚ñë -->
    <main id="cy" class="w-full"></main>

    <!-- ‚ñë‚ñë‚ñë Modal D√©tails ‚ñë‚ñë‚ñë -->
    <div class="modal micromodal-slide" id="detail-modal" aria-hidden="true">
      <div
        class="modal__overlay fixed inset-0 flex items-center justify-center bg-black/60"
        data-micromodal-close
      >
        <div
          class="modal__container bg-slate-800 rounded-2xl p-6 max-w-3xl w-full mx-4 shadow-2xl"
          role="dialog"
          aria-modal="true"
          aria-labelledby="detail-title"
        >
          <header class="modal__header flex justify-between items-center mb-4">
            <h2 id="detail-title" class="text-xl font-bold">Details</h2>
            <button
              class="text-slate-400 hover:text-white"
              data-micromodal-close
              aria-label="Close"
            >
              ‚úñ
            </button>
          </header>
          <div
            id="modal-content"
            class="modal__content max-h-[60vh] overflow-y-auto"
          ></div>
          <footer class="modal__footer mt-6 text-right">
            <button
              class="px-4 py-2 bg-indigo-600 hover:bg-indigo-500 rounded text-white"
              data-micromodal-close
            >
              Close
            </button>
          </footer>
        </div>
      </div>
    </div>

    <!-- ‚ñë‚ñë‚ñë Modal L√©gende ‚ñë‚ñë‚ñë -->
    <div class="modal micromodal-slide" id="legend-modal" aria-hidden="true">
      <div
        class="modal__overlay fixed inset-0 flex items-center justify-center bg-black/60"
        data-micromodal-close
      >
        <div
          class="modal__container bg-slate-800 rounded-2xl p-6 max-w-4xl w-full mx-4 shadow-2xl"
          role="dialog"
          aria-modal="true"
          aria-labelledby="legend-title"
        >
          <header class="modal__header flex justify-between items-center mb-4">
            <h2 id="legend-title" class="text-xl font-bold">
              L√©gende & natures des ressources
            </h2>
            <button
              class="text-slate-400 hover:text-white"
              data-micromodal-close
              aria-label="Close"
            >
              ‚úñ
            </button>
          </header>

          <!-- Contenu statique de la l√©gende (identique √† l'original) -->
          <div class="modal__content max-h-[70vh] overflow-y-auto">
            <table class="w-full text-sm table-fixed border-collapse">
              <thead class="text-slate-300 border-b border-slate-700">
                <tr>
                  <th class="w-24 py-2">Ic√¥ne</th>
                  <th class="w-52 py-2">Cat√©gorie Azure</th>
                  <th class="py-2">R√¥le</th>
                </tr>
              </thead>
              <tbody class="divide-y divide-slate-700">
                <tr class="hover:bg-slate-700/30">
                  <td class="py-2 flex justify-center">
                    <span class="inline-block w-4 h-4 rounded-full bg-[#6366f1]"></span>
                  </td>
                  <td class="py-2 font-semibold">Virtual Network (VNet)</td>
                  <td class="py-2">P√©rim√®tre r√©seau principal, plage IP globale.</td>
                </tr>
                <tr class="hover:bg-slate-700/30">
                  <td class="py-2 flex justify-center">
                    <span class="inline-block w-4 h-4 rounded-full bg-[#22d3ee]"></span>
                  </td>
                  <td class="py-2 font-semibold">Subnet</td>
                  <td class="py-2">Segment du VNet (plage IP + r√®gles).</td>
                </tr>
                <tr class="hover:bg-slate-700/30">
                  <td class="py-2 flex justify-center">
                    <span class="inline-block w-4 h-4 rotate-45 bg-[#ef4444]"></span>
                  </td>
                  <td class="py-2 font-semibold">Network Security Group (NSG)</td>
                  <td class="py-2">Pare‚Äëfeu L3/L4 : r√®gles Allow/Deny.</td>
                </tr>
                <tr class="hover:bg-slate-700/30">
                  <td class="py-2 flex justify-center">
                    <span
                      class="inline-block w-0 h-0 border-l-8 border-r-8 border-b-[14px] border-transparent border-b-[#facc15]"
                    ></span>
                  </td>
                  <td class="py-2 font-semibold">Public IP (PIP)</td>
                  <td class="py-2">Adresse routable depuis Internet.</td>
                </tr>
                <tr class="hover:bg-slate-700/30">
                  <td class="py-2 flex justify-center">
                    <span
                      class="inline-block w-4 h-4 bg-[#a855f7]"
                      style="clip-path: polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%)"
                    ></span>
                  </td>
                  <td class="py-2 font-semibold">Network Interface (NIC)</td>
                  <td class="py-2">Carte r√©seau virtuelle, porte l‚ÄôIP.</td>
                </tr>
                <tr class="hover:bg-slate-700/30">
                  <td class="py-2 flex justify-center">
                    <span class="inline-block w-4 h-4 bg-[#4ade80]"></span>
                  </td>
                  <td class="py-2 font-semibold">Virtual Machine (VM)</td>
                  <td class="py-2">Instance compute.</td>
                </tr>
              </tbody>
            </table>
          </div>

          <footer class="modal__footer mt-6 text-right">
            <button
              class="px-4 py-2 bg-indigo-600 hover:bg-indigo-500 rounded text-white"
              data-micromodal-close
            >
              Fermer
            </button>
          </footer>
        </div>
      </div>
    </div>

    <!-- ‚ñë‚ñë‚ñë Scripts applicatifs (ES modules) ‚ñë‚ñë‚ñë -->
    <script defer src="./app.js"></script>

    <!-- ‚Äî‚Äî Initialisation des modales ‚Äî‚Äî -->
    <script>
      MicroModal.init({ disableScroll: true, awaitCloseAnimation: true });
    </script>
  </body>
</html>
